{"version":3,"sources":["../../src/providers/chat/chat.service.ts","../../src/models/user.model.ts","../../src/pages/chat/chat.ts","../../src/pages/user-profile/user-profile.ts","../../node_modules/@angular/core/@angular lazy","../../src lazy","../../src/models/message.model.ts","../../src/providers/message/message.service.ts","../../src/components/base.component.ts","../../src/app/main.ts","../../src/app/app.module.ts","../../src/providers/auth/auth.service.ts","../../src/providers/user/user.service.ts","../../src/models/chat.model.ts","../../src/pipes/capitalize/capitalize.ts","../../src/components/custom-logged-header/custom-logged-header.component.ts","../../src/components/message-box/message-box.component.ts","../../src/app/app.component.ts","../../src/components/progress-bar/progress-bar.component.ts","../../src/components/user-info/user-info.component.ts","../../src/components/user-menu/user-menu.component.ts","../../src/providers/base/base.service.ts","../../src/pages/home/home.ts","../../src/pages/signin/signin.ts","../../src/pages/signup/signup.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAA2C;AACN;AACN;AAEiF;AAC7D;AAInD;IAAiC,+BAAW;IAI1C,qBACS,EAAe,EACf,IAAU;QAFnB,YAIE,iBAAO,SAER;QALQ,QAAE,GAAF,EAAE,CAAa;QACf,UAAI,GAAJ,IAAI,CAAM;QAGjB,KAAI,CAAC,QAAQ,EAAE,CAAC;;IAClB,CAAC;IAEO,8BAAQ,GAAhB;QAAA,iBAgBC;QAfC,IAAI,CAAC,EAAE,CAAC,IAAI;aACT,SAAS,CAAC,UAAC,SAA4B;YACvC,uBAAuB;YACtB,EAAE,EAAC,SAAS,CAAC,CAAC,CAAC;gBACf,mCAAmC;gBACjC,KAAI,CAAC,KAAK,GAAmC,KAAI,CAAC,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAC,YAAU,SAAS,CAAC,IAAI,CAAC,GAAK,EAAE;oBACjG,KAAK,EAAE;wBACL,YAAY,EAAE,WAAW,CAAC,8EAA8E;qBACzG;iBACF,CAAC,CAAC,GAAG,CAAC,UAAC,KAAa;oBACnB,MAAM,CAAC,KAAK,CAAC,OAAO,EAAE,CAAC,CAAC,sBAAsB;gBAChD,CAAC,CAAC,CAAC,KAAK,CAAC,KAAI,CAAC,qBAAqB,CAAC,CAAC;YAEvC,CAAC;QACH,CAAC,CAAC;IACN,CAAC;IAED,4BAAM,GAAN,UAAO,IAAU,EAAE,OAAe,EAAE,OAAe;QACjD,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,QAAQ,CAAC,MAAM,CAAC,YAAU,OAAO,SAAI,OAAS,CAAC;aAC3D,GAAG,CAAC,IAAI,CAAC;aACT,KAAK,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;QACnC,oDAAoD;IACrD,CAAC;IAED,iCAAW,GAAX,UAAY,OAAe,EAAE,OAAe;QAC1C,MAAM,CAAkC,IAAI,CAAC,EAAE,CAAC,QAAQ,CAAC,MAAM,CAAC,YAAU,OAAO,SAAI,OAAS,CAAC;aAC5F,KAAK,CAAC,IAAI,CAAC,qBAAqB,CAAC,CAAC;IACvC,CAAC;IAED,iCAAW,GAAX,UAAY,IAAoC,EAAE,SAAiB,EAAE,kBAA0B;QAC7F,EAAE,CAAC,CAAC,SAAS,IAAI,kBAAkB,CAAC,CAAC,CAAC;YACtC,0CAA0C;YACxC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC;gBACjB,KAAK,EAAE,kBAAkB;aAC1B,CAAC,CAAC,IAAI,CAAC;gBACN,MAAM,CAAC,IAAI,CAAC;YACd,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;QACpC,CAAC;QACD,MAAM,CAAC,OAAO,CAAC,OAAO,EAAE,CAAC;IAC3B,CAAC;IApDU,WAAW;QADvB,yEAAU,EAAE;yCAME,iEAAW;YACT,2DAAI;OANR,WAAW,CAsDvB;IAAD,kBAAC;CAAA,CAtDgC,uEAAW,GAsD3C;AAtDuB;;;;;;;;;ACTxB;AAAA;IAGI,cACW,IAAY,EACZ,QAAgB,EAChB,KAAa,EACb,KAAa;QAHb,SAAI,GAAJ,IAAI,CAAQ;QACZ,aAAQ,GAAR,QAAQ,CAAQ;QAChB,UAAK,GAAL,KAAK,CAAQ;QACb,UAAK,GAAL,KAAK,CAAQ;IACrB,CAAC;IAAA,CAAC;IAET,WAAC;AAAD,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACVoD;AACa;AAIA;AAEF;AACX;AACsB;AAET;AAElC;AAOhC;IAaE,kBACS,WAAwB,EACxB,WAAwB,EACxB,cAA8B,EAC9B,OAAsB,EACtB,SAAoB,EACpB,WAAwB;QALxB,gBAAW,GAAX,WAAW,CAAa;QACxB,gBAAW,GAAX,WAAW,CAAa;QACxB,mBAAc,GAAd,cAAc,CAAgB;QAC9B,YAAO,GAAP,OAAO,CAAe;QACtB,cAAS,GAAT,SAAS,CAAW;QACpB,gBAAW,GAAX,WAAW,CAAa;IAC9B,CAAC;IAEJ,kCAAe,GAAf;QACE,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,aAAa,CAAC;IACxC,CAAC;IAED,iCAAc,GAAd;QAAA,iBAoEC;QAnEC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,eAAe,CAAC,CAAC,CAAC,oCAAoC;QAC1F,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC;QACrC,IAAI,CAAC,WAAW,CAAC,WAAW;aACzB,KAAK,EAAE;aACP,SAAS,CAAC,UAAC,WAAiB;YAC3B,KAAI,CAAC,MAAM,GAAG,WAAW,CAAC;YAE3B,kDAAkD;YACjD,KAAI,CAAC,KAAK,GAAG,KAAI,CAAC,WAAW,CAAC,WAAW,CAAC,KAAI,CAAC,MAAM,CAAC,IAAI,EAAE,KAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;YACjF,KAAI,CAAC,KAAK,GAAG,KAAI,CAAC,WAAW,CAAC,WAAW,CAAC,KAAI,CAAC,SAAS,CAAC,IAAI,EAAC,KAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;YAEjF,sBAAsB;YACrB,EAAE,CAAC,CAAC,KAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,CAAC;gBACzB,KAAI,CAAC,KAAK;qBACP,KAAK,EAAE;qBACP,SAAS,CAAC,UAAC,IAAU;oBACpB,KAAI,CAAC,WAAW,CAAC,WAAW,CAAC,KAAI,CAAC,KAAK,EAAE,IAAI,CAAC,KAAK,EAAE,KAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;gBAC7E,CAAC,CAAC;YACN,CAAC;YAGD,IAAI,cAAc,GAAG;gBACnB,KAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,UAAC,QAAmB;oBAC1C,KAAI,CAAC,cAAc,EAAE,CAAC;gBACxB,CAAC,CAAC;YACJ,CAAC,CAAC;YAEF,IAAI,uBAAuB,GAAG;gBAC5B,KAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,UAAC,OAAkB;oBACzC,OAAO,CAAC,MAAM,CAAC,UAAC,GAAY;wBAC1B,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,IAAI,KAAK,IAAI,GAAG,CAAC,IAAI,IAAI,SAAS,CAAC,IAAI,GAAG,CAAC,MAAM,IAAI,KAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC;4BACnF,KAAI,CAAC,cAAc,CAAC,cAAc,CAAC,KAAI,CAAC,MAAM,CAAC,IAAI,EAAE,KAAI,CAAC,SAAS,CAAC,IAAI,EAAE,GAAG,CAAC,IAAI,CAAC,CAAC;wBACtF,CAAC;oBACH,CAAC,CAAC;gBACJ,CAAC,CAAC,CAAC;YACL,CAAC;YAED,IAAI,0BAA0B,GAAG;gBAC/B,KAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,UAAC,OAAkB;oBACzC,OAAO,CAAC,MAAM,CAAC,UAAC,GAAY;wBAC1B,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,IAAI,KAAK,IAAI,GAAG,CAAC,IAAI,IAAI,SAAS,CAAC,IAAI,GAAG,CAAC,MAAM,IAAI,KAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC;4BACnF,KAAI,CAAC,cAAc,CAAC,cAAc,CAAC,KAAI,CAAC,SAAS,CAAC,IAAI,EAAE,KAAI,CAAC,MAAM,CAAC,IAAI,EAAE,GAAG,CAAC,IAAI,CAAC,CAAC;wBACtF,CAAC;oBACH,CAAC,CAAC;gBACJ,CAAC,CAAC,CAAC;YACL,CAAC;YAED,oEAAoE;YACrE,4EAA4E;YAC3E,KAAI,CAAC,QAAQ,GAAG,KAAI,CAAC,cAAc,CAAC,WAAW,CAAC,KAAI,CAAC,MAAM,CAAC,IAAI,EAAE,KAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;YACxF,qDAAqD;YACpD,KAAI,CAAC,QAAQ;iBACV,KAAK,EAAE;iBACP,SAAS,CAAC,UAAC,WAAsB;gBAEhC,EAAE,CAAC,CAAC,WAAW,CAAC,MAAM,KAAK,CAAC,CAAC,CAAC,CAAC;oBAChC,8CAA8C;oBAC3C,KAAI,CAAC,QAAQ,GAAG,KAAI,CAAC,cAAc,CAAC,WAAW,CAAC,KAAI,CAAC,SAAS,CAAC,IAAI,EAAE,KAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;oBACvF,0BAA0B,EAAE,CAAC;gBAC/B,CAAC;gBAAC,IAAI,CAAC,CAAC;oBACP,wDAAwD;oBACvD,uBAAuB,EAAE,CAAC;gBAC5B,CAAC;gBACD,cAAc,EAAE,CAAC;YAEnB,CAAC,CAAC;QACR,CAAC,CAAC,CAAC;IACL,CAAC;IAED,8BAAW,GAAX,UAAY,UAAkB;QAA9B,iBAsBC;QArBC,EAAE,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC;YACf,IAAI,kBAAgB,GAAW,gDAAQ,CAAC,QAAQ,CAAC,WAAW,CAAC,SAAS,CAAC;YACvE,IAAI,CAAC,cAAc;iBAClB,MAAM,CAAG,2BAA2B;YACnC,IAAI,sEAAO,CAAE,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE,UAAU,EAAE,kBAAgB,EAAE,KAAK,CAAC,EACnE,IAAI,CAAC,QAAQ,CACd,CAAC,IAAI,CAAC;gBACL,+CAA+C;gBAC/C,KAAI,CAAC,KAAK;qBACP,MAAM,CAAC;oBACN,WAAW,EAAE,UAAU;oBACvB,SAAS,EAAE,kBAAgB;iBAC5B,CAAC,CAAC;gBACL,KAAI,CAAC,KAAK;qBACP,MAAM,CAAC;oBACN,WAAW,EAAE,UAAU;oBACvB,SAAS,EAAE,kBAAgB;iBAC5B,CAAC,CAAC;YACP,CAAC,CAAC;QAEJ,CAAC;IACH,CAAC;IAED,wCAAwC;IAChC,iCAAc,GAAtB,UAAuB,QAAiB;QAAxC,iBAOC;QANC,UAAU,CAAC;YACT,EAAE,CAAC,CAAC,KAAI,CAAC,OAAO,CAAC,CAAC,CAAC;gBACjB,KAAI,CAAC,OAAO,CAAC,cAAc,CAAC,QAAQ,IAAI,GAAG,CAAC,CAAC;YAC/C,CAAC;QACH,CAAC,EAAE,EAAE,CAAC;IAER,CAAC;IA9HmB;QAAnB,0EAAS,CAAC,8DAAO,CAAC;kCAAU,8DAAO;6CAAC;IAF1B,QAAQ;QAJpB,wEAAS,CAAC;YACT,QAAQ,EAAE,WAAW;WACG;SACzB,CAAC;8FAeiC;YACX,0FAAW;YACR,qEAAc;YACrB,iEAAa;YACX,iFAAS;YACP,KAAW;OAnBtB,QAAQ,CAkIpB;IAAD,CAAC;AAAA;SAlIY,QAAQ,e;;;;;;;;;;;;;;;;;;;;;;ACpBwC;AACJ;AAEO;AAEE;AAOlE;IAME,kEAAkE;IAElE,yBACS,WAAwB,EACxB,EAAqB,EACrB,OAAsB,EACtB,SAAoB,EACpB,WAAwB;QAJxB,gBAAW,GAAX,WAAW,CAAa;QACxB,OAAE,GAAF,EAAE,CAAmB;QACrB,YAAO,GAAP,OAAO,CAAe;QACtB,cAAS,GAAT,SAAS,CAAW;QACpB,gBAAW,GAAX,WAAW,CAAa;QAVjC,YAAO,GAAY,KAAK,CAAC;IAWtB,CAAC;IAEJ,yCAAe,GAAf;QACE,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,aAAa,CAAC;IACxC,CAAC;IAED,wCAAc,GAAd;QAAA,iBAKC;QAJC,IAAI,CAAC,WAAW,CAAC,WAAW;aACzB,SAAS,CAAC,UAAC,IAAU;YACpB,KAAI,CAAC,WAAW,GAAG,IAAI,CAAC;QAC1B,CAAC,CAAC;IACN,CAAC;IAED,kCAAQ,GAAR,UAAS,KAAY;QAArB,iBAsBC;QArBC,KAAK,CAAC,cAAc,EAAE,CAAC,CAAC,0BAA0B;QAElD,EAAE,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;YACnB,IAAI,YAAU,GAAG,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,EAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;YAE1F,6DAA6D;YACtD,uEAAuE;YACxE,YAAU,CAAC,EAAE,CAAC,eAAe,EAAE,UAAC,QAA6C;gBAC3E,KAAI,CAAC,cAAc,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,QAAQ,CAAC,gBAAgB,GAAG,QAAQ,CAAC,UAAU,CAAC,GAAG,GAAG,CAAC,CAAC;gBAC3F,yGAAyG;gBACxG,KAAI,CAAC,EAAE,CAAC,aAAa,EAAE,CAAC;gBACzB,6EAA6E;YAC9E,CAAC,EAAE,UAAC,KAAY;gBACd,aAAa;YACf,CAAC,EAAE;gBACD,KAAI,CAAC,QAAQ,CAAC,YAAU,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC,CAAC,mBAAmB;YACrE,CAAC,CAAE;QAEL,CAAC;QAAC,IAAI,CAAC,CAAC;YACN,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAE,6BAA6B;QACjD,CAAC;IACH,CAAC;IAED,iCAAO,GAAP,UAAQ,KAAK;QACX,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,2DAA2D;IACrG,CAAC;IAEO,kCAAQ,GAAhB,UAAiB,QAAiB;QAAlC,iBAYC;QAXC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC;YACpB,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,IAAI;YAC3B,QAAQ,EAAE,IAAI,CAAC,WAAW,CAAC,QAAQ;YACnC,KAAK,EAAE,QAAQ,IAAK,IAAI,CAAC,WAAW,CAAC,KAAK,IAAI,EAAE;YAChD,2GAA2G;SAC5G,CAAC,CAAC,IAAI,CAAC;YACN,KAAI,CAAC,OAAO,GAAG,KAAK,CAAC,CAAC,iBAAiB;YACvC,KAAI,CAAC,SAAS,GAAG,SAAS,CAAC,CAAC,uBAAuB;YACnD,KAAI,CAAC,cAAc,GAAG,CAAC,CAAC,CAAC,sBAAsB;YAC/C,KAAI,CAAC,EAAE,CAAC,aAAa,EAAE,CAAC;QAC1B,CAAC,CAAC,CAAC;IACL,CAAC;IAnEU,eAAe;QAJ3B,wEAAS,CAAC;YACT,QAAQ,EAAE,mBAAmB;WACG;SACjC,CAAC;qFAUiC;YACpB,qEAAiB;YACZ,iEAAa;YACX,iFAAS;YACP,WAAW;OAbtB,eAAe,CAqE3B;IAAD,CAAC;AAAA;SArEY,eAAe,gB;;;;;;;ACZ5B;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,4CAA4C,WAAW;AACvD;AACA;AACA,kC;;;;;;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,qC;;;;;;;;AC9BA;AAAA;IAGI,iBACW,MAAc,EACd,IAAY,EACZ,SAAc,EACd,IAAa;QAHb,WAAM,GAAN,MAAM,CAAQ;QACd,SAAI,GAAJ,IAAI,CAAQ;QACZ,cAAS,GAAT,SAAS,CAAK;QACd,SAAI,GAAJ,IAAI,CAAS;IACrB,CAAC;IACR,cAAC;AAAD,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACT0C;AACN;AACN;AAEoB;AACgB;AAInE;IAAoC,kCAAW;IAE7C,wBACS,IAAU,EACV,EAAe;QAFxB,YAIE,iBAAO,SACR;QAJQ,UAAI,GAAJ,IAAI,CAAM;QACV,QAAE,GAAF,EAAE,CAAa;;IAGxB,CAAC;IAED,oCAAW,GAAX,UAAY,OAAe,EAAE,OAAe;QAC1C,MAAM,CAAoC,IAAI,CAAC,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAC,eAAa,OAAO,SAAI,OAAS,EAAE;YACjG,KAAK,EAAE;gBACL,YAAY,EAAE,WAAW;gBACzB,WAAW,EAAE,EAAE,CAAC,qCAAqC;aACtD;SACF,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,qBAAqB,CAAC,CAAC;IACvC,CAAC;IAED,uCAAc,GAAd,UAAe,OAAe,EAAE,OAAe,EAAE,SAAiB;QAClE,mFAAmF;QACjF,IAAI,CAAC,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAC,eAAa,OAAO,SAAI,OAAS,CAAC;aACrD,MAAM,CAAC,SAAS,EAAE;YACjB,IAAI,EAAE,IAAI;SACX,CACF;IAEH,CAAC;IAED,+BAAM,GAAN,UAAO,OAAgB,EAAE,YAA+C;QACtE,MAAM,CAAC,YAAY,CAAC,IAAI,CAAC,OAAO,CAAC;aAC9B,KAAK,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;IACpC,CAAC;IA/BU,cAAc;QAD1B,yEAAU,EAAE;yCAII,2DAAI;YACN,iEAAW;OAJb,cAAc,CAiC1B;IAAD,qBAAC;CAAA,CAjCmC,uEAAW,GAiC9C;AAjC0B;;;;;;;;;;;ACN2B;AACtD,0DAA0D;AAC1D,iFAAiF;AAEjF;IAII;wDACoD;IAEpD,uBACW,SAA0B,EAC1B,WAAwB,EACxB,GAAQ,EACR,QAAwB;QAHxB,cAAS,GAAT,SAAS,CAAiB;QAC1B,gBAAW,GAAX,WAAW,CAAa;QACxB,QAAG,GAAH,GAAG,CAAK;QACR,aAAQ,GAAR,QAAQ,CAAgB;IAChC,CAAC;IAEJ,gCAAQ,GAAR;QACI,6EAA6E;QAC7E,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC,CAAC,CAAC,CAAC;IAC/C,CAAC;IAED,gCAAQ,GAAR;QAAA,iBAiBC;QAhBG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;YAClB,OAAO,EAAE,oBAAoB;YAC7B,OAAO,EAAE;gBACL;oBACI,IAAI,EAAE,KAAK;oBACX,OAAO,EAAE;wBACL,KAAI,CAAC,WAAW,CAAC,MAAM,EAAE;6BACpB,IAAI,CAAE;4BACH,KAAI,CAAC,OAAO,CAAC,OAAO,CAAC,wEAAU,CAAC,CAAC;4BACjC,KAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,KAAK,EAAE,WAAW,CAAC,CAAC;wBAC7C,CAAC,CAAC;oBACV,CAAC;iBACJ;gBACD,EAAC,IAAI,EAAE,IAAI,EAAC;aACf;SACJ,CAAC,CAAC,OAAO,EAAE,CAAC,CAAC,iBAAiB;IACnC,CAAC;IAEL,oBAAC;AAAD,CAAC;;;;;;;;;;;;;AC7C0E;AAElC;AAEzC,yGAAsB,EAAE,CAAC,eAAe,CAAC,8DAAS,CAAC,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACJM;AACH;AACZ;AAC8B;AACd;AACN;AAE2C,CAAC,+BAA+B;AAEnE;AACG;AAClB;AACe;AACmD;AAClE;AAC0C;AAClB;AAC9B;AACmD;AACvC;AACA;AAC8B;AACA;AACrB;AACU;AAEvE,IAAM,iBAAiB,GAAsB;IAC3C,MAAM,EAAE,yCAAyC;IACjD,UAAU,EAAE,gCAAgC;IAC5C,WAAW,EAAE,uCAAuC;IACpD,aAAa,EAAE,4BAA4B;CAE5C,CAAC;AAGF,IAAM,kBAAkB,GAAG;IACzB,QAAQ,EAAE,mEAAa,CAAC,MAAM;IAC9B,MAAM,EAAE,iEAAW,CAAC,QAAQ;CAC7B;AAkDD;IAAA;IAAwB,CAAC;IAAZ,SAAS;QAhDrB,uEAAQ,CAAC;YACR,YAAY,EAAE;gBACZ,oFAAc;gBACd,kEAAQ;gBACR,qIAA2B;gBAC3B,mEAAQ;gBACR,2GAAmB;gBACnB,8DAAK;gBACL,8GAAoB;gBACpB,yEAAU;gBACV,yEAAU;gBACV,qGAAiB;gBACjB,qGAAiB;gBACjB,0FAAe;aAChB;YACD,OAAO,EAAE;gBACP,uEAAiB,CAAC,aAAa,CAAC,iBAAiB,EAAE,kBAAkB,CAAC;gBACtE,gFAAa;gBACb,iEAAU;gBACV,kEAAW,CAAC,OAAO,CAAC,8DAAK,EAAE,EAAE,EACjC;oBACE,KAAK,EAAE;wBACL,EAAE,YAAY,EAAE,0CAA0C,EAAE,IAAI,EAAE,UAAU,EAAE,OAAO,EAAE,MAAM,EAAE,QAAQ,EAAE,KAAK,EAAE,cAAc,EAAE,EAAE,EAAE;wBACpI,EAAE,YAAY,EAAE,gDAAgD,EAAE,IAAI,EAAE,YAAY,EAAE,OAAO,EAAE,QAAQ,EAAE,QAAQ,EAAE,KAAK,EAAE,cAAc,EAAE,EAAE,EAAE;wBAC9I,EAAE,YAAY,EAAE,gDAAgD,EAAE,IAAI,EAAE,YAAY,EAAE,OAAO,EAAE,QAAQ,EAAE,QAAQ,EAAE,KAAK,EAAE,cAAc,EAAE,EAAE,EAAE;wBAC9I,EAAE,YAAY,EAAE,iEAAiE,EAAE,IAAI,EAAE,iBAAiB,EAAE,OAAO,EAAE,cAAc,EAAE,QAAQ,EAAE,KAAK,EAAE,cAAc,EAAE,EAAE,EAAE;qBAC3K;iBACF,CAAC;aACC;YACD,SAAS,EAAE,CAAC,+DAAQ,CAAC;YACrB,eAAe,EAAE;gBACf,kEAAQ;gBACR,mEAAQ;gBACR,8DAAK;gBACL,yEAAU;gBACV,yEAAU;gBACV,0FAAe;aAChB;YACD,SAAS,EAAE;gBACT,iFAAW;gBACX,kFAAW;gBACX,2EAAS;gBACT,iFAAY;gBACZ,EAAC,OAAO,EAAE,mEAAY,EAAE,QAAQ,EAAE,wEAAiB,EAAC;gBACpD,kFAAW;gBACX,2FAAc;aACf;SACF,CAAC;OACW,SAAS,CAAG;IAAD,gBAAC;CAAA;AAAH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACxFqB;AACN;AACN;AACwC;AACpB;AAKnD;IAAiC,+BAAW;IAE1C,qBACS,IAAqB,EACrB,IAAU;QAFnB,YAIE,iBAAO,SACR;QAJQ,UAAI,GAAJ,IAAI,CAAiB;QACrB,UAAI,GAAJ,IAAI,CAAM;;IAGnB,CAAC;IAED,oCAAc,GAAd,UAAe,IAAuC;QACpD,2FAA2F;QAC5F,mEAAmE;QAClE,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC;aAC9B,KAAK,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;IACpC,CAAC;IAED,qCAAe,GAAf,UAAgB,IAAuC;QACrD,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC;aACzB,IAAI,CAAC,UAAC,SAA4B;YACjC,MAAM,CAAC,SAAS,IAAI,IAAI,CAAC,CAAC,4DAA4D;QAExF,CAAC,CAAC;aACD,KAAK,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;IACpC,CAAC;IAED,4BAAM,GAAN;QACE,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC;IAC5B,CAAC;IAED,sBAAI,sCAAa;aAAjB;YAAA,iBASC;YARC,MAAM,CAAC,IAAI,OAAO,CAAC,UAAC,OAAO,EAAE,MAAM;gBACjC,KAAI,CAAC,IAAI;qBACR,KAAK,EAAE,CAAE,4BAA4B;qBACrC,SAAS,CAAC,UAAC,SAA4B;oBACtC,qFAAqF;oBACrF,CAAC,SAAS,CAAC,GAAG,OAAO,CAAC,IAAI,CAAC,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC,CAAE,qCAAqC;gBACrF,CAAC,CAAC;YACJ,CAAC,CAAC;QACJ,CAAC;;;OAAA;IAtCU,WAAW;QADvB,yEAAU,EAAE;yCAII,0EAAe;YACf,2DAAI;OAJR,WAAW,CAwCvB;IAAD,kBAAC;CAAA,CAxCgC,uEAAW,GAwC3C;AAxCuB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACT2B;AACd;AACN;AAE2E;AAGvD;AAInD;IAAiC,+BAAW;IAK1C,qBACS,EAAe,EAAE,iEAAiE;QAC1F,wJAAwJ;QAE5H,WAAgB,EAAG,uGAAuG;QAC9I,IAAU;QALnB,YAOE,iBAAO,SAGR;QATQ,QAAE,GAAF,EAAE,CAAa;QAGK,iBAAW,GAAX,WAAW,CAAK;QACpC,UAAI,GAAJ,IAAI,CAAM;QAGjB,gDAAgD;QAChD,KAAI,CAAC,eAAe,EAAE,CAAC;;IACzB,CAAC;IAEO,qCAAe,GAAvB;QAAA,iBAQC;QAPC,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,UAAC,SAA4B;YAClD,EAAE,EAAC,SAAS,CAAC,CAAC,CAAC;gBACb,KAAI,CAAC,WAAW,GAAG,KAAI,CAAC,EAAE,CAAC,QAAQ,CAAC,MAAM,CAAC,YAAU,SAAS,CAAC,IAAI,CAAC,GAAK,CAAC,CAAC;gBAC3E,KAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG,CAAC;gBACjC,2CAA2C;YAC7C,CAAC;QACH,CAAC,CAAC,CAAC;IACL,CAAC;IAEO,8BAAQ,GAAhB,UAAkB,YAAoB;QAC/B,IAAI,CAAC,KAAK,GAAuC,IAAI,CAAC,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAE,QAAQ,EAAE;YAChF,KAAK,EAAE;gBACL,YAAY,EAAE,MAAM,CAAC,gBAAgB;aACtC;SACF,CAAC,CAAE,GAAG,CAAE,UAAC,KAAc;YACtB,MAAM,CAAC,KAAK,CAAC,MAAM,CAAE,UAAC,IAAU,IAAK,WAAI,CAAE,IAAK,IAAI,YAAY,EAA3B,CAA2B,CAAC,CAAC;YAClE,0FAA0F;QAC5F,CAAC,CAAC;IACJ,CAAC;IAEN,4BAAM,GAAN,UAAQ,IAAU,EAAE,YAAoB;QACjC,sHAAsH;QACtH,sHAAsH;QAEtH,wHAAwH;QACxH,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,QAAQ,CAAC,MAAM,CAAE,YAAU,YAAc,CAAC;aACtD,GAAG,CAAE,IAAI,CAAC;aACV,KAAK,CAAE,IAAI,CAAC,kBAAkB,CAAC,CAAC;IAErC,CAAC;IAEN,0BAAI,GAAJ,UAAK,IAAqD;QACxD,MAAM,CAAC,IAAI,CAAC,WAAW;aACpB,MAAM,CAAC,IAAI,CAAC;aACZ,KAAK,CAAC,IAAI,CAAC,kBAAkB,CAAC;IACnC,CAAC;IAED,gCAAU,GAAV,UAAY,QAAgB;QACrB,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAE,QAAQ,EAAE;YACtC,KAAK,EAAE;gBACL,YAAY,EAAE,UAAU;gBACxB,OAAO,EAAE,QAAQ,CAAC,uCAAuC;aAC1D;SACF,CAAC,CAAE,GAAG,CAAE,UAAC,KAAc;YACtB,MAAM,CAAC,KAAK,CAAC,MAAM,GAAE,CAAC,CAAC,CAAC,uEAAuE;QACjG,CAAC,CAAC,CAAE,KAAK,CAAE,IAAI,CAAC,qBAAqB,CAAC,CAAC,CAAC,+DAA+D;QAEvG,eAAe;IACjB,CAAC;IAEN,uCAAiB,GAAjB,UAAmB,KAAa;QACzB,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAE,QAAQ,EAAE;YACtC,KAAK,EAAE;gBACL,YAAY,EAAE,OAAO;gBACrB,OAAO,EAAE,KAAK,CAAC,qCAAqC;aACrD;SACF,CAAC,CAAE,GAAG,CAAE,UAAC,KAAc;YACtB,MAAM,CAAC,KAAK,CAAC,MAAM,GAAE,CAAC,CAAC,CAAC,uEAAuE;QACjG,CAAC,CAAC,CAAE,KAAK,CAAE,IAAI,CAAC,qBAAqB,CAAC,CAAC,CAAC,+DAA+D;QAEvG,eAAe;IACjB,CAAC;IAEN,6BAAO,GAAP,UAAQ,MAAc;QACpB,MAAM,CAAiC,IAAI,CAAC,EAAE,CAAC,QAAQ,CAAC,MAAM,CAAC,YAAU,MAAQ,CAAC;aAC/E,KAAK,CAAC,IAAI,CAAC,qBAAqB,CAAC,CAAC;IACvC,CAAC;IAGD,iCAAW,GAAX,UAAa,SAAe,EAAE,MAAc;QACrC,oDAAoD;QACpD,MAAM,CAAC,IAAI,CAAC,WAAW;aACpB,OAAO,EAAG;aACV,GAAG,EAAG,CAAC,sCAAsC;aAC7C,KAAK,CAAE,aAAW,MAAQ,CAAC,CAAC,+CAA+C;aAC3E,GAAG,CAAE,SAAS,CAAC,CAAC,CAAC,gDAAgD;IACtE,CAAC;IA9FK,WAAW;QADvB,yEAAU,EAAE;QAUT,gFAAM,CAAC,iEAAW,CAAC;yCAHR,iEAAW,UAIT,2DAAI;OAVR,WAAW,CAgGvB;IAAD,kBAAC;CAAA,CAhGgC,uEAAW,GAgG3C;AAhGuB;;;;;;;;;ACXxB;AAAA;IAII,yIAAyI;IACzI,cACW,WAAmB,EACnB,SAAc,EACd,KAAa,EACb,KAAa;QAHb,gBAAW,GAAX,WAAW,CAAQ;QACnB,cAAS,GAAT,SAAS,CAAK;QACd,UAAK,GAAL,KAAK,CAAQ;QACb,UAAK,GAAL,KAAK,CAAQ;IACrB,CAAC;IAER,WAAC;AAAD,CAAC;;;;;;;;;;;;;;;;;;ACZmD;AAKpD;IAAA;IAiBA,CAAC;IAfC,kCAAS,GAAT,UAAU,KAAa,EAAE,SAAkB;QACzC,8BAA8B;QAE9B,EAAE,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC;YACd,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,GAAE,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;QACxD,CAAC;QAED,IAAI,KAAK,GAAa,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;QACvC,IAAI,KAAK,GAAW,EAAE,CAAC;QAEvB,KAAK,CAAC,OAAO,CAAC,UAAC,KAAa,EAAE,KAAa,EAAE,KAAe;YAC1D,KAAK,IAAI,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,GAAG,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,GAAE,GAAG,CAAC;QAC9E,CAAC,CAAC;QACF,MAAM,CAAC,KAAK,CAAC;IACf,CAAC;IAhBU,cAAc;QAH1B,mEAAI,CAAC;YACJ,IAAI,EAAE,YAAY;SACnB,CAAC;OACW,cAAc,CAiB1B;IAAD,qBAAC;CAAA;AAjB0B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACLsB;AACC;AACoB;AACN;AACjB;AAM/C;IAAiD,+CAAa;IAK5D,qCACS,SAA0B,EAC1B,WAAwB,EACxB,GAAQ,EACR,QAAwB;QAJjC,YAME,kBAAM,SAAS,EAAC,WAAW,EAAC,GAAG,EAAC,QAAQ,CAAC,SAC1C;QANQ,eAAS,GAAT,SAAS,CAAiB;QAC1B,iBAAW,GAAX,WAAW,CAAa;QACxB,SAAG,GAAH,GAAG,CAAK;QACR,cAAQ,GAAR,QAAQ,CAAgB;;IAGjC,CAAC;IAVQ;QAAR,oEAAK,EAAE;;8DAAe;IACd;QAAR,oEAAK,EAAE;kCAAO,gEAAI;6DAAC;IAHT,2BAA2B;QAJvC,wEAAS,CAAC;YACT,QAAQ,EAAE,sBAAsB;WACkB;SACnD,CAAC;8FAOmC;YACb,2DAAW;YACnB,qEAAG;YACE,cAAc;OATtB,2BAA2B,CAcvC;wEAAD,GAAC;AAAA;SAdY,2BAA2B,sB;;;;;;;;;;;;;;;;;;;;ACVS;AAEM;AAEvD;;EAEE;AAYF;IAOE;IAAe,CAAC;IAJP;QAAR,oEAAK,EAAE;kCAAU,sEAAO;wDAAC;IACjB;QAAR,oEAAK,EAAE;;6DAAuB;IACtB;QAAR,oEAAK,EAAE;;4DAAsB;IALnB,mBAAmB;QAV/B,wEAAS,CAAC;YACT,QAAQ,EAAE,aAAa;YACvB,OAAyC;YACzC,IAAI,EAAE;gBACN,2EAAqG;aACzB;WAG3E;SACF,CAAC;;OACW,mBAAmB,CAS/B;IAAD,CAAC;AAAA;SATY,mBAAmB,qB;;;;;;;;;;;;;;;;;;;;;;;;;;AClBU;AACD;AACY;AACM;AAII;AACjB;AACM;AAES;AAC7D,yDAAyD;AAKzD;IAKE,eACE,WAAwB,EACxB,QAAkB,EAClB,SAAoB,EACpB,YAA0B,EAC1B,WAAwB;QAL1B,iBAwBC;QA3BD,aAAQ,GAAO,wEAAU,CAAC;QAWxB,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC,UAAC,SAA4B;YACtD,EAAE,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC;gBACd,KAAI,CAAC,QAAQ,GAAG,kEAAQ,CAAC;gBACzB,WAAW,CAAC,WAAW,CAAC,SAAS,CAAC,UAAC,IAAU;oBAC3C,KAAI,CAAC,WAAW,GAAG,IAAI,CAAC,CAAE,+CAA+C;gBAC3E,CAAC,CAAC;YACJ,CAAC;YAAC,IAAI,CAAC,CAAC;gBACN,KAAI,CAAC,QAAQ,GAAG,wEAAU,CAAC;YAC7B,CAAC;QACH,CAAC,CAAC;QAEF,QAAQ,CAAC,KAAK,EAAE,CAAC,IAAI,CAAC;YACpB,SAAS,CAAC,YAAY,EAAE,CAAC;YACzB,YAAY,CAAC,IAAI,EAAE,CAAC;QACtB,CAAC,CAAC,CAAC;IAEL,CAAC;IA7BU,KAAK;QAHjB,wEAAS,CAAC;WACc;SACxB,CAAC;4EAO0B;YACd,2EAAQ;YACP,iFAAS;YACN,kFAAY;YACb,EAAW;OAVf,KAAK,CA8BjB;IAAD,CAAC;AAAA;SA9BY,KAAK,2B;;;;;;;;;;;;;;;;;;;ACjB+B;AAMjD;IAIE;IAAe,CAAC;IAFP;QAAR,oEAAK,EAAE;;0DAAkB;IAFf,oBAAoB;QAJhC,wEAAS,CAAC;YACT,QAAQ,EAAE,cAAc;WACkB;SAC3C,CAAC;;OACW,oBAAoB,CAMhC;IAAD,CAAC;AAAA;SANY,oBAAoB,qB;;;;;;;;;;;;;;;;;;;;ACNgB;AACF;AAM/C;IAKE;QAFS,WAAM,GAAY,KAAK,CAAC;IAElB,CAAC;IAHP;QAAR,oEAAK,EAAE;kCAAO,gEAAI;mDAAC;IACX;QAAR,oEAAK,EAAE;;qDAAyB;IAHtB,iBAAiB;QAJ7B,wEAAS,CAAC;YACT,QAAQ,EAAE,WAAW;WACkB;SACxC,CAAC;;OACW,iBAAiB,CAO7B;IAAD,CAAC;AAAA;SAPY,iBAAiB,qB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACPmB;AACoB;AAEL;AACd;AACH;AAC2B;AAM1E;IAAuC,qCAAa;IAKlD,2BACS,SAA0B,EAC1B,WAAwB,EACxB,GAAQ,EACR,QAAwB;QAJjC,YAME,kBAAM,SAAS,EAAE,WAAW,EAAE,GAAG,EAAE,QAAQ,CAAC,SAC7C;QANQ,eAAS,GAAT,SAAS,CAAiB;QAC1B,iBAAW,GAAX,WAAW,CAAa;QACxB,SAAG,GAAH,GAAG,CAAK;QACR,cAAQ,GAAR,QAAQ,CAAgB;;IAGjC,CAAC;IAED,qCAAS,GAAT;QACE,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,yFAAe,CAAC,CAAC;IACrC,CAAC;IAbc;QAAd,oEAAK,CAAC,MAAM,CAAC;kCAAc,gEAAI;0DAAC;IAHtB,iBAAiB;QAJ7B,wEAAS,CAAC;YACT,QAAQ,EAAE,WAAW;WACkB;SACxC,CAAC;8FAOmC;YACb,2DAAW;YACnB,qEAAG;YACE,cAAc;OATtB,iBAAiB,CAkB7B;wEAAD,GAAC;AAAA;SAlBY,iBAAiB,qB;;;;;;;;;;;;ACZW;AACP;AAElC,IAAM,YAAY,GAAG,UAAC,KAAqB;IACvC,oEAAoE;IACpE,IAAI,MAAc,CAAC;IACnB,EAAE,CAAC,CAAC,KAAK,YAAY,+DAAQ,CAAC,CAAC,CAAC;QAC5B,IAAM,IAAI,GAAG,KAAK,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC;QAChC,IAAM,GAAG,GAAG,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;QAC/C,MAAM,GAAM,KAAK,CAAC,MAAM,YAAM,KAAK,CAAC,UAAU,IAAI,EAAE,UAAI,GAAK,CAAC;IAClE,CAAC;IAAC,IAAI,CAAC,CAAC;QACJ,MAAM,GAAG,KAAK,CAAC,OAAO,GAAG,KAAK,CAAC,OAAO,GAAG,KAAK,CAAC,QAAQ,EAAE,CAAC;IAC9D,CAAC;IACD,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;IAEtB,MAAM,CAAC,MAAM,CAAC;AAClB,CAAC;AAED;IAAA;IAUA,CAAC;IATE,yGAAyG;IAC3F,wCAAkB,GAA5B,UAA6B,KAAqB;QACjD,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC;IAC/C,CAAC;IAES,2CAAqB,GAA/B,UAAgC,KAAqB;QACjD,MAAM,CAAC,gDAAU,CAAC,KAAK,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC;IACjD,CAAC;IAEL,kBAAC;AAAD,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC5ByC;AACgD;AAI1B;AACjB;AACL;AACsB;AAClB;AAEoB;AAElC;AAMhC;IAME,kBACS,WAAwB,EACxB,WAAwB,EACxB,WAA8B,EAC9B,QAAwB,EACxB,OAAsB,EACtB,WAAwB;QALxB,gBAAW,GAAX,WAAW,CAAa;QACxB,gBAAW,GAAX,WAAW,CAAa;QACxB,gBAAW,GAAX,WAAW,CAAmB;QAC9B,aAAQ,GAAR,QAAQ,CAAgB;QACxB,YAAO,GAAP,OAAO,CAAe;QACtB,gBAAW,GAAX,WAAW,CAAa;QARjC,SAAI,GAAW,OAAO,CAAC;IAWvB,CAAC;IAED,kCAAe,GAAf;QACE,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,aAAa,CAAC;IACxC,CAAC;IAED,iCAAc,GAAd;QAEE,IAAI,CAAC,WAAW,EAAE,CAAC;QAEnB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC;QACpC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC;QACpC,uEAAuE;QACvE,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,EAAE,WAAW,CAAC,CAAC,CAAC,8CAA8C;IAEzF,CAAC;IAED,2BAAQ,GAAR;QACE,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,kEAAU,CAAC,CAAC;IAChC,CAAC;IAED,+BAAY,GAAZ,UAAa,aAAmB;QAAhC,iBA0BC;QAxBC,IAAI,CAAC,WAAW,CAAC,WAAW,CAAE,mFAAmF;aAC9G,KAAK,EAAE;aACP,SAAS,CAAC,UAAC,WAAiB;YAC3B,KAAI,CAAC,WAAW,CAAC,WAAW,CAAC,WAAW,CAAC,IAAI,EAAC,aAAa,CAAC,IAAI,CAAC,CAAC,4BAA4B;iBAC3F,KAAK,EAAE;iBACP,SAAS,CAAC,UAAC,IAAU;gBAEpB,EAAE,EAAC,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;oBACjC,6BAA6B;oBAC7B,IAAI,SAAS,GAAW,gDAAQ,CAAC,QAAQ,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC,8BAA8B;oBAE/F,IAAI,KAAK,GAAG,IAAI,gEAAI,CAAC,EAAE,EAAC,SAAS,EAAC,aAAa,CAAC,IAAI,EAAE,CAAC,aAAa,CAAC,KAAK,IAAI,EAAE,CAAC,CAAC,CAAC,CAAC,yCAAyC;oBAC7H,KAAI,CAAC,WAAW,CAAC,MAAM,CAAC,KAAK,EAAC,WAAW,CAAC,IAAI,EAAC,aAAa,CAAC,IAAI,CAAC,CAAC;oBAEnE,IAAI,KAAK,GAAG,IAAI,gEAAI,CAAC,EAAE,EAAC,SAAS,EAAC,WAAW,CAAC,IAAI,EAAC,CAAC,WAAW,CAAC,KAAK,IAAI,EAAE,CAAC,CAAC,CAAC;oBAC9E,KAAI,CAAC,WAAW,CAAC,MAAM,CAAC,KAAK,EAAC,aAAa,CAAC,IAAI,EAAC,WAAW,CAAC,IAAI,CAAC,CAAC;gBACrE,CAAC;YAEH,CAAC,CAAC,CAAC;QAEP,CAAC,CAAC;QACF,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,4DAAQ,EAAE;YAC1B,aAAa,EAAE,aAAa,CAAE,yEAAyE;SACxG,CAAC,CAAC;IACP,CAAC;IAED,6BAAU,GAAV,UAAW,IAAU;QAArB,iBASC;QARC,IAAI,eAAe,GAAW,IAAI,CAAC,IAAI,CAAC,CAAC,sCAAsC;QAC/E,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,eAAe,CAAC;aACtC,KAAK,EAAE;aACP,SAAS,CAAC,UAAC,IAAU;YACpB,KAAI,CAAC,OAAO,CAAC,IAAI,CAAC,4DAAQ,EAAE;gBAC1B,aAAa,EAAE,IAAI,CAAE,yEAAyE;aAC/F,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;IACP,CAAC;IAED,8BAAW,GAAX,UAAY,KAAU;QACpB,IAAI,UAAU,GAAW,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC;QAC5C,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC;QACpC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC;QAEpC,EAAE,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC;YACf,MAAM,EAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;gBAEjB,KAAK,OAAO;oBACV,IAAI,CAAC,KAAK,GAAmC,IAAI,CAAC,KAAK;yBACpD,GAAG,CAAC,UAAC,KAAa;wBACjB,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,UAAC,IAAU;4BAC7B,oDAAoD;4BACpD,oDAAoD;4BACpD,MAAM,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC,OAAO,CAAC,UAAU,CAAC,WAAW,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;wBAC3E,CAAC,CAAC;oBACN,CAAC,CAAC;oBACF,KAAK,CAAC;gBAER,KAAK,OAAO;oBACV,IAAI,CAAC,KAAK,GAAmC,IAAI,CAAC,KAAK;yBACpD,GAAG,CAAC,UAAC,KAAa;wBACjB,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,UAAC,IAAU;4BAC7B,oDAAoD;4BACpD,oDAAoD;4BACpD,MAAM,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC,OAAO,CAAC,UAAU,CAAC,WAAW,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;wBAC1E,CAAC,CAAC;oBACN,CAAC,CAAC;oBACF,KAAK,CAAC;YACV,CAAC;QACH,CAAC;IACH,CAAC;IAGO,8BAAW,GAAnB;QACE,IAAI,OAAO,GAAY,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC;YAC7C,OAAO,EAAE,gBAAgB;YACzB,QAAQ,EAAE,GAAG;SACd,CAAC,CAAC;QAEH,OAAO,CAAC,OAAO,EAAE,CAAC;QAElB,MAAM,CAAC,OAAO,CAAC;IACjB,CAAC;IAtHU,QAAQ;QAJpB,wEAAS,CAAC;YACT,QAAQ,EAAE,WAAW;WACG;SACzB,CAAC;8FAQiC;YACX,wEAAW;YACX,sEAAiB;YACpB,qEAAc;YACf,mFAAa;YACT,KAAW;OAZtB,QAAQ,CAwHpB;IAAD,CAAC;AAAA;SAxHY,QAAQ,e;;;;;;;;;;;;;;;;;;;;;;;;;ACnBqB;AACyC;AACf;AAEJ;AACwB;AAE9C;AACM;AAOhD;IAIE,oBACS,SAA0B,EAC1B,WAAwB,EACxB,WAAwB,EACxB,WAA8B,EAC9B,OAAsB,EACtB,SAAoB;QALpB,cAAS,GAAT,SAAS,CAAiB;QAC1B,gBAAW,GAAX,WAAW,CAAa;QACxB,gBAAW,GAAX,WAAW,CAAa;QACxB,gBAAW,GAAX,WAAW,CAAmB;QAC9B,YAAO,GAAP,OAAO,CAAe;QACtB,cAAS,GAAT,SAAS,CAAW;QAE3B,IAAI,UAAU,GAAG,mGAAmG,CAAC;QAErH,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC;YACvC,KAAK,EAAE,CAAC,EAAE,EAAE,kEAAU,CAAC,OAAO,CAAC,CAAC,kEAAU,CAAC,QAAQ,EAAE,kEAAU,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;YACtF,QAAQ,EAAE,CAAC,EAAE,EAAE,CAAC,kEAAU,CAAC,QAAQ,EAAE,kEAAU,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;SAC/D,CAAC,CAAC;IACL,CAAC;IAED,6BAAQ,GAAR;QACE,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,kEAAU,CAAC,CAAC;IAChC,CAAC;IAED,6BAAQ,GAAR;QAAA,iBAgBC;QAfC,IAAI,OAAO,GAAY,IAAI,CAAC,WAAW,EAAE,CAAC,CAAE,mBAAmB;QAC/D,IAAI,IAAI,GAAG,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC;QAEjC,IAAI,CAAC,WAAW,CAAC,eAAe,CAAC,IAAI,CAAC;aACnC,IAAI,CAAC,UAAC,QAAiB;YACtB,EAAE,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC;gBACb,KAAI,CAAC,OAAO,CAAC,OAAO,CAAC,4DAAQ,CAAC,CAAC;gBAC/B,OAAO,CAAC,OAAO,EAAE,CAAC;YACpB,CAAC;QACH,CAAC,CAAC;aACD,KAAK,CAAC,UAAC,EAAO;YACb,OAAO,CAAC,OAAO,EAAE,CAAC;YAClB,KAAI,CAAC,SAAS,CAAC,EAAE,CAAC;QACpB,CAAC,CAAC;IAEN,CAAC;IAEO,gCAAW,GAAnB;QACE,IAAI,OAAO,GAAY,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC;YAC7C,OAAO,EAAE,gBAAgB;SAC1B,CAAC,CAAC;QAEH,OAAO,CAAC,OAAO,EAAE,CAAC;QAElB,MAAM,CAAC,OAAO,CAAC;IACjB,CAAC;IAEO,8BAAS,GAAjB,UAAkB,OAAe;QAC/B,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;YACpB,OAAO,EAAE,OAAO;YAChB,OAAO,EAAE,CAAC,IAAI,CAAC;SAChB,CAAC,CAAC,OAAO,EAAE,CAAC;IACf,CAAC;IAzDU,UAAU;QAJtB,wEAAS,CAAC;YACT,QAAQ,EAAE,aAAa;WACG;SAC3B,CAAC;8FAMmC;YACb,mEAAW;YACX,8GAAW;YACX,qEAAiB;YACrB,kEAAa;YACX,OAAS;OAVlB,UAAU,CA2DtB;IAAD,CAAC;AAAA;SA3DY,UAAU,e;;;;;;;;;;;;;;;;;;;;;;;;;;ACfmB;AACe;AAGW;AAGc;AACM;AAExB;AACE;AAClE,kDAAkD;AAER;AAC1C,2DAA2D;AAO3D;IAKE,oBACS,SAA0B,EAC1B,WAAwB,EAAG,gDAAgD;QAC3E,WAAwB,EAAK,gCAAgC;QAC7D,WAA8B,EAAG,oBAAoB;QACrD,OAAsB,EACtB,SAAoB,EACpB,WAAwB;QANxB,cAAS,GAAT,SAAS,CAAiB;QAC1B,gBAAW,GAAX,WAAW,CAAa;QACxB,gBAAW,GAAX,WAAW,CAAa;QACxB,gBAAW,GAAX,WAAW,CAAmB;QAC9B,YAAO,GAAP,OAAO,CAAe;QACtB,cAAS,GAAT,SAAS,CAAW;QACpB,gBAAW,GAAX,WAAW,CAAa;QATjC,kBAAa,GAAY,IAAI,CAAC;QAW5B,0DAA0D;QAC1D,wHAAwH;QACxH,IAAI,UAAU,GAAG,wJAAwJ,CAAC;QAE1K,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC;YACvC,gFAAgF;YAChF,IAAI,EAAE,CAAC,EAAE,EAAE,CAAC,kEAAU,CAAC,QAAQ,EAAE,kEAAU,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;YAC1D,QAAQ,EAAE,CAAC,EAAE,EAAE,CAAC,kEAAU,CAAC,QAAQ,EAAE,kEAAU,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;YAC9D,oMAAoM;YACpM,KAAK,EAAE,CAAC,EAAE,EAAE,kEAAU,CAAC,OAAO,CAAC,CAAC,kEAAU,CAAC,QAAQ,EAAE,kEAAU,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;YACtF,QAAQ,EAAE,CAAC,EAAE,EAAE,CAAC,kEAAU,CAAC,QAAQ,EAAE,kEAAU,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;SAC/D,CAAC,CAAC;IACL,CAAC;IAED,6BAAQ,GAAR;QAAA,iBAiDC;QAhDC,IAAI,OAAO,GAAY,IAAI,CAAC,WAAW,EAAE,CAAC;QAC1C,0FAA0F;QAC1F,4FAA4F;QAE5F,IAAI,QAAQ,GAAG,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC;QAErC,IAAI,QAAQ,GAAW,QAAQ,CAAC,QAAQ,CAAC;QAEzC,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC,wBAAwB;aAC3D,KAAK,EAAE,CAAE,0EAA0E;aACnF,SAAS,CAAC,UAAC,UAAmB;YAC7B,EAAE,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC;gBAEhB,KAAI,CAAC,WAAW,CAAC,cAAc,CAAC;oBAC9B,iFAAiF;oBACjF,KAAK,EAAE,QAAQ,CAAC,KAAK;oBACrB,QAAQ,EAAE,QAAQ,CAAC,QAAQ;iBAC5B,CAAC,CAAC,IAAI,CAAC,UAAC,SAA4B;oBACnC,gDAAgD;oBAChD,6FAA6F;oBAC7F,OAAO,QAAQ,CAAC,QAAQ,CAAC;oBAEzB,wGAAwG;oBACxG,qCAAqC;oBAErC,IAAI,YAAY,GAAW,SAAS,CAAC,IAAI,CAAC,GAAG,CAAC;oBAE9C,KAAI,CAAC,WAAW,CAAC,MAAM,CAAC,QAAQ,EAAE,YAAY,CAAC,CAAC,gCAAgC;yBAC7E,IAAI,CAAC;wBACJ,OAAO,CAAC,OAAO,EAAE,CAAC;wBAClB,KAAI,CAAC,OAAO,CAAC,OAAO,CAAC,4DAAQ,CAAC,CAAC;oBACjC,CAAC,CAAC,CAAC,KAAK,CAAC,UAAC,KAAU;wBAClB,OAAO,CAAC,OAAO,EAAE,CAAC;wBAClB,KAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;oBACxB,CAAC,CAAC,CAAC;gBAEP,CAAC,CAAC,CAAC,KAAK,CAAC,UAAC,KAAU;oBAClB,OAAO,CAAC,OAAO,EAAE,CAAC;oBAClB,KAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;gBACxB,CAAC,CAAC;YAEJ,CAAC;YAAC,IAAI,CAAC,CAAC;gBACN,KAAI,CAAC,SAAS,CAAC,4CAA4C,CAAC,CAAC;gBAC7D,OAAO,CAAC,OAAO,EAAE,CAAC;YACpB,CAAC;QACH,CAAC,CAAC,CAAC;IAGP,CAAC;IAEO,gCAAW,GAAnB;QACE,IAAI,OAAO,GAAY,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC;YAC7C,OAAO,EAAE,gBAAgB;SAC1B,CAAC,CAAC;QAEH,OAAO,CAAC,OAAO,EAAE,CAAC;QAElB,MAAM,CAAC,OAAO,CAAC;IACjB,CAAC;IAEO,8BAAS,GAAjB,UAAkB,OAAe;QAC/B,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;YACpB,OAAO,EAAE,OAAO;YAChB,OAAO,EAAE,CAAC,IAAI,CAAC;SAChB,CAAC,CAAC,OAAO,EAAE,CAAC;IACf,CAAC;IA9FU,UAAU;QAJtB,wEAAS,CAAC;YACT,QAAQ,EAAE,aAAa;WACG;SAC3B,CAAC;8FAOmC;YACb,mEAAW;YACX,8GAAW;YACX,qEAAiB;YACrB,iEAAa;YACX,iFAAS;YACP,OAAW;OAZtB,UAAU,CAgGtB;IAAD,CAAC;AAAA;SAhGY,UAAU,e","file":"main.js","sourcesContent":["import { Injectable } from '@angular/core';\nimport { Http } from '@angular/http';\nimport 'rxjs/add/operator/map';\n\nimport { AngularFire, FirebaseAuthState, FirebaseListObservable, FirebaseObjectObservable } from 'angularfire2';\nimport { BaseService } from '../base/base.service';\nimport { Chat } from '../../models/chat.model';\n\n@Injectable()\nexport class ChatService extends BaseService {\n\n  chats: FirebaseListObservable<Chat[]>\n\n  constructor(\n    public af: AngularFire,\n    public http: Http\n  ) {\n    super();\n    this.setChats();\n  }\n  \n  private setChats(): void {\n    this.af.auth\n      .subscribe((authState: FirebaseAuthState) => {\n       // if user is logged in\n        if(authState) {\n         // auth is the user's node (if any)\n          this.chats = <FirebaseListObservable<Chat[]>>this.af.database.list(`/chats/${authState.auth.uid}`, {\n            query: {\n              orderByChild: 'timeStamp' // returns in GROWING order (q must be descending, ie the most recent message)\n            }\n          }).map((chats: Chat[]) => {\n            return chats.reverse(); // reverse array order\n          }).catch(this.handleObservableError);\n\n        }\n      })\n  }\n\n  create(chat: Chat, userId1: string, userId2: string): firebase.Promise<void> {\n    return this.af.database.object(`/chats/${userId1}/${userId2}`)\n      .set(chat)\n      .catch(this.handlePromiseError);\n  // chats nodes are composed by the id of the 2 users\n  }\n\n  getDeepChat(userId1: string, userId2: string): FirebaseObjectObservable<Chat>{\n    return <FirebaseObjectObservable<Chat>> this.af.database.object(`/chats/${userId1}/${userId2}`)\n      .catch(this.handleObservableError);\n  }\n\n  updatePhoto(chat: FirebaseObjectObservable<Chat>, chatPhoto: string, recipientUserPhoto: string): firebase.Promise<void> {\n    if (chatPhoto != recipientUserPhoto) {\n     // Then you have to update the chat photo.\n      return chat.update({\n        photo: recipientUserPhoto\n      }).then(() => {\n        return true;\n      }).catch(this.handlePromiseError); \n    }\n    return Promise.resolve();\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/providers/chat/chat.service.ts","export class User {\n      // it does not pass in the constructor pq this $ key is automatically generated in the firebase and would conflict when creating the chat\n \n    public $key: string;  \n    constructor(\n        public name: string,\n        public username: string,\n        public email: string,\n        // public password: string,\n          public photo: string,\n    ) {};\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/models/user.model.ts","import { Component, ViewChild } from '@angular/core';\nimport { Content, IonicPage, NavController, NavParams } from 'ionic-angular';\n\nimport { FirebaseListObservable, FirebaseObjectObservable } from 'angularfire2';\n\nimport { AuthService } from './../../providers/auth/auth.service';\nimport { Chat } from '../../models/chat.model';\nimport { ChatService } from '../../providers/chat/chat.service';\nimport { Message } from '../../models/message.model';\nimport { MessageService } from './../../providers/message/message.service';\nimport { User } from '../../models/user.model';\nimport { UserService } from './../../providers/user/user.service';\n\nimport firebase from 'firebase';\n\n@IonicPage()\n@Component({\n  selector: 'page-chat',\n  templateUrl: 'chat.html',\n})\nexport class ChatPage {\n\n  @ViewChild(Content) content: Content; // get the ion-content instance of the page (to do the scroll)\n  messages: FirebaseListObservable<Message[]>;\n  pageTitle: string;\n  sender: User;   // sender\n\n  recipient: User; //recipient\n// the 2 attributes below will be used to update the last message of the home view (used in the ionViewDidLoad guard)\n  private chat1: FirebaseObjectObservable<Chat>;  //sender chat\n  private chat2: FirebaseObjectObservable<Chat>;  //recipient chat\n\n  constructor(\n    public authService: AuthService,\n    public chatService: ChatService,\n    public messageService: MessageService,\n    public navCtrl: NavController,\n    public navParams: NavParams,\n    public userService: UserService\n  ) {}\n\n  ionViewCanEnter(): Promise<boolean> {\n    return this.authService.authenticated;\n  }\n\n  ionViewDidLoad(): void {\n    this.recipient = this.navParams.get('recipientUser'); //receive from home.ts\n    this.pageTitle = this.recipient.name;\n    this.userService.currentUser\n      .first()\n      .subscribe((currentUser: User)=> {\n        this.sender = currentUser;\n\n       // take the chats for the sender and the recipient\n       this.chat1 = this.chatService.getDeepChat(this.sender.$key, this.recipient.$key);\n       this.chat2 = this.chatService.getDeepChat(this.recipient.$key,this.sender.$key);\n\n      // update user's photo\n       if (this.recipient.photo) {\n         this.chat1\n           .first()\n           .subscribe((chat: Chat) => {\n             this.chatService.updatePhoto(this.chat1, chat.photo, this.recipient.photo);\n           })\n       }\n        \n\n        let doSubscription = () => {\n          this.messages.subscribe((messages: Message[]) => {\n            this.scrollToBottom();\n          })\n        };\n\n        let updateSenderReadMessage = () => {\n          this.messages.subscribe((message: Message[]) => {\n            message.filter((msg: Message) => {\n              if ((msg.read == false || msg.read == undefined) && msg.userId != this.sender.$key) { // DEPOIS EXPLICO A GAMBIARRA\n                this.messageService.setMessageRead(this.sender.$key, this.recipient.$key, msg.$key);\n              }\n            })\n          });\n        }\n\n        let updateRecipientReadMessage = () => {\n          this.messages.subscribe((message: Message[]) => {\n            message.filter((msg: Message) => {\n              if ((msg.read == false || msg.read == undefined) && msg.userId != this.sender.$key) { // DEPOIS EXPLICO A GAMBIARRA\n                this.messageService.setMessageRead(this.recipient.$key, this.sender.$key, msg.$key);\n              }\n            })\n          });\n        }\n\n          // search for chat messages: (have to see if the user order is right\n       // sometimes the sender (id 1) in vdd is the recipient (id 2) and vice versa\n        this.messages = this.messageService.getMessages(this.sender.$key, this.recipient.$key);\n       // check if there is any message in this type of chat\n        this.messages\n          .first()\n          .subscribe((messageList: Message[]) => {\n\n            if (messageList.length === 0) { // if there is no such message\n           // make the search with the ID's changed order\n              this.messages = this.messageService.getMessages(this.recipient.$key, this.sender.$key);\n              updateRecipientReadMessage();\n            } else {\n             // if the chat Node is the first sender ID of the sender\n              updateSenderReadMessage();\n            }\n            doSubscription();\n            \n          })\n    });\n  }\n\n  sendMessage(newMessage: string): void {\n    if (newMessage) {\n      let currentTimeStamp: Object = firebase.database.ServerValue.TIMESTAMP;\n      this.messageService\n      .create(  // create method parameters\n        new Message (this.sender.$key, newMessage, currentTimeStamp, false),\n        this.messages\n      ).then(() => {\n       //update last message and timestamp of 2 cheats\n        this.chat1\n          .update({\n            lastMessage: newMessage,\n            timeStamp: currentTimeStamp\n          });\n        this.chat2\n          .update({\n            lastMessage: newMessage,\n            timeStamp: currentTimeStamp\n          });\n      })\n    \n    }\n  }\n\n   // optional animation duration parameter\n  private scrollToBottom(duration?: number): void {\n    setTimeout(() => {\n      if (this.content) { // if you have already loaded this.content (do not be undefined)\n        this.content.scrollToBottom(duration || 300);\n      }\n    }, 50)\n    \n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/chat/chat.ts","import { Component, ChangeDetectorRef } from '@angular/core';\nimport { IonicPage, NavController, NavParams } from 'ionic-angular';\n\nimport { AuthService } from '../../providers/auth/auth.service';\nimport { User } from '../../models/user.model';\nimport { UserService } from './../../providers/user/user.service';\n\n@IonicPage()\n@Component({\n  selector: 'page-user-profile',\n  templateUrl: 'user-profile.html',\n})\nexport class UserProfilePage {\n\n  currentUser: User;\n  canEdit: boolean = false;\n  uploadProgress: number;\n  private filePhoto: File;  // store the most current photo of the user (which is in the form)\n\n\n  constructor(\n    public authService: AuthService,\n    public cd: ChangeDetectorRef,\n    public navCtrl: NavController,\n    public navParams: NavParams,\n    public userService: UserService\n  ) {}\n\n  ionViewCanEnter(): Promise<boolean> {\n    return this.authService.authenticated;\n  }\n\n  ionViewDidLoad() {\n    this.userService.currentUser\n      .subscribe((user: User) => {\n        this.currentUser = user;\n      })\n  }\n\n  onSubmit(event: Event): void {\n    event.preventDefault(); /// Do not refresh the page\n\n    if (this.filePhoto) {\n      let uploadTask = this.userService.uploadPhoto(this.filePhoto,this.currentUser.$key);\n\n   // will hear the status change of this task (when completing)\n          // the snapshot is a callback to access the current state of the upload\n      uploadTask.on('state_changed', (snapshot: firebase.storage.UploadTaskSnapshot) => {\n        this.uploadProgress = Math.round((snapshot.bytesTransferred / snapshot.totalBytes) * 100);\n        // divide the amount that has already been sent by the total and multiply by 100 to obtain the percentage\n        this.cd.detectChanges();\n       // detect the changes that occurred in the calculation to update the template\n \n      }, (error: Error) => {  // callback error\n        //catch error\n      }, () => {  // callback when you finish uploading\n        this.editUser(uploadTask.snapshot.downloadURL); // complete the url\n      } )\n\n    } else {\n      this.editUser();  // / calls the private function\n    }\n  }\n\n  onPhoto(event): void { \n    this.filePhoto = event.target.files[0]; //Since you are uploading only 1 photo, we use the index 0\n  }\n\n  private editUser(photoUrl?: string): void {\n    this.userService.edit({\n      name: this.currentUser.name,\n      username: this.currentUser.username,\n      photo: photoUrl  || this.currentUser.photo || ''\n      // if you have received a new photo, put the new photo, if not, use the old one, if it is not already empty\n    }).then(() => {\n      this.canEdit = false; // close the form\n      this.filePhoto = undefined; // resets the attribute\n      this.uploadProgress = 0; // progress bar is 0%;\n      this.cd.detectChanges();\n    });\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/user-profile/user-profile.ts","function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncatched exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tthrow new Error(\"Cannot find module '\" + req + \"'.\");\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = 164;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/@angular/core/@angular lazy\n// module id = 164\n// module chunks = 4","var map = {\n\t\"../pages/chat/chat.module\": [\n\t\t610,\n\t\t3\n\t],\n\t\"../pages/signin/signin.module\": [\n\t\t611,\n\t\t2\n\t],\n\t\"../pages/signup/signup.module\": [\n\t\t612,\n\t\t1\n\t],\n\t\"../pages/user-profile/user-profile.module\": [\n\t\t613,\n\t\t0\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tvar ids = map[req];\n\tif(!ids)\n\t\treturn Promise.reject(new Error(\"Cannot find module '\" + req + \"'.\"));\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(ids[0]);\n\t});\n};\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 204;\nmodule.exports = webpackAsyncContext;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src lazy\n// module id = 204\n// module chunks = 4","export class Message {\n      // it does not pass in the constructor pq this $ key is automatically generated in the firebase and would conflict when creating the chat\n \n    public $key: string; \n    constructor(\n        public userId: string,\n        public text: string,\n        public timeStamp: any,\n        public read: boolean\n    ) {}\n}\n\n\n// WEBPACK FOOTER //\n// ./src/models/message.model.ts","import { Injectable } from '@angular/core';\nimport { Http } from '@angular/http';\nimport 'rxjs/add/operator/map';\n\nimport { BaseService } from '../base/base.service';\nimport { FirebaseListObservable, AngularFire } from 'angularfire2';\nimport { Message } from '../../models/message.model'\n\n@Injectable()\nexport class MessageService extends BaseService{\n\n  constructor(\n    public http: Http,\n    public af: AngularFire,\n  ) {\n    super();\n  }\n\n  getMessages(userId1: string, userId2: string): FirebaseListObservable<Message[]> {\n    return <FirebaseListObservable<Message[]>>this.af.database.list(`/messages/${userId1}-${userId2}`, {\n      query: {\n        orderByChild: 'timeStamp',\n        limitToLast: 30 // limits to get the last 30 messages\n      }\n    }).catch(this.handleObservableError);\n  }\n\n  setMessageRead(userId1: string, userId2: string, messageId: string): void {\n    // this.af.database.list(`/messages/${userId1}-${userId2}/${messageId}`)\n    this.af.database.list(`/messages/${userId1}-${userId2}`)\n      .update(messageId, {\n        read: true\n      }\n    )\n\n  }\n\n  create(message: Message, listMessages: FirebaseListObservable<Message[]>): firebase.Promise<void> {\n    return listMessages.push(message)\n      .catch(this.handlePromiseError);\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/providers/message/message.service.ts","// import { AlertController } from 'ionic-angular/components/alert/alert-controller';\nimport { AlertController, App, MenuController, NavController } from 'ionic-angular';\nimport { AuthService } from '../providers/auth/auth.service';\nimport { OnInit } from '@angular/core/src/metadata/lifecycle_hooks';\nimport { SigninPage } from './../pages/signin/signin';\n// import { App } from 'ionic-angular/components/app/app';\n// import { MenuController } from 'ionic-angular/components/app/menu-controller';\n\nexport abstract class baseComponent implements OnInit{\n\n    protected navCtrl: NavController;\n\n \n    /*  You can use this component within a menu or page header\n         Well, take the current navigation (ngOnInit) */\n\n    constructor(\n        public alertCtrl: AlertController,\n        public authService: AuthService,\n        public app: App,\n        public menuCtrl: MenuController\n    ) {}\n\n    ngOnInit(): void {\n       // this.navCtrl = this.app.getActiveNav(); // receives the used navController\n       this.navCtrl = this.app.getActiveNavs()[0];\n    }\n\n    onLogOut(): void {\n        this.alertCtrl.create({\n            message: \"Do you wanna quit?\",\n            buttons: [\n                {\n                    text: \"Yes\",\n                    handler: () => {                // if you click YES (you want to exit)\n                        this.authService.logOut()\n                            .then( () => {\n                                this.navCtrl.setRoot(SigninPage);\n                                this.menuCtrl.enable(false, 'user-menu');\n                            })\n                    }\n                },\n                {text: \"No\"}\n            ]\n        }).present(); // show the alert\n    }\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/components/base.component.ts","import { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app.module';\n\nplatformBrowserDynamic().bootstrapModule(AppModule);\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/main.ts","import { BrowserModule } from '@angular/platform-browser';\nimport { ErrorHandler, NgModule } from '@angular/core';\nimport { HttpModule } from '@angular/http';\nimport { IonicApp, IonicErrorHandler, IonicModule } from 'ionic-angular';\nimport { SplashScreen } from '@ionic-native/splash-screen';\nimport { StatusBar } from '@ionic-native/status-bar';\n\nimport { AngularFireModule, AuthMethods, AuthProviders, FirebaseAppConfig } from 'angularfire2'; //importa o firebase app config\n\nimport { AuthService } from '../providers/auth/auth.service';\nimport { CapitalizePipe } from '../pipes/capitalize/capitalize';\nimport { ChatPage } from '../pages/chat/chat';\nimport { ChatService } from '../providers/chat/chat.service';\nimport { CustomLoggedHeaderComponent } from '../components/custom-logged-header/custom-logged-header.component';\nimport { HomePage } from '../pages/home/home';\nimport { MessageBoxComponent } from './../components/message-box/message-box.component';\nimport { MessageService } from '../providers/message/message.service';\nimport { MyApp } from './app.component';\nimport { ProgressBarComponent } from './../components/progress-bar/progress-bar.component';\nimport { SignupPage } from '../pages/signup/signup';\nimport { SigninPage } from '../pages/signin/signin';\nimport { UserInfoComponent } from './../components/user-info/user-info.component';\nimport { UserMenuComponent } from './../components/user-menu/user-menu.component';\nimport { UserService } from '../providers/user/user.service';\nimport { UserProfilePage } from './../pages/user-profile/user-profile';\n\nconst firebaseAppConfig: FirebaseAppConfig = {\n  apiKey: \"AIzaSyD6hBifmAuDZWHcjQch5MrTRv70e_cQrpo\",\n  authDomain: \"fir-chat-c9b65.firebaseapp.com\",\n  databaseURL: \"https://fir-chat-c9b65.firebaseio.com\",\n  storageBucket: \"fir-chat-c9b65.appspot.com\",\n  // messagingSenderId: \"717491479259\"\n};\n\n\nconst firebaseAuthConfig = {\n  provider: AuthProviders.Custom,\n  method: AuthMethods.Password\n}\n\n@NgModule({\n  declarations: [\n    CapitalizePipe,\n    ChatPage,\n    CustomLoggedHeaderComponent,\n    HomePage,\n    MessageBoxComponent,\n    MyApp,\n    ProgressBarComponent,\n    SigninPage,\n    SignupPage,\n    UserInfoComponent,\n    UserMenuComponent,\n    UserProfilePage\n  ],\n  imports: [\n    AngularFireModule.initializeApp(firebaseAppConfig, firebaseAuthConfig),\n    BrowserModule,\n    HttpModule,\n    IonicModule.forRoot(MyApp)\n  ],\n  bootstrap: [IonicApp],\n  entryComponents: [\n    ChatPage,\n    HomePage,\n    MyApp,\n    SigninPage,\n    SignupPage,\n    UserProfilePage\n  ],\n  providers: [\n    AuthService,\n    ChatService,\n    StatusBar,\n    SplashScreen,\n    {provide: ErrorHandler, useClass: IonicErrorHandler},\n    UserService,\n    MessageService,\n  ]\n})\nexport class AppModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/app.module.ts","import { Injectable } from '@angular/core';\nimport { Http } from '@angular/http';\nimport 'rxjs/add/operator/map';\nimport { AngularFireAuth, FirebaseAuthState } from 'angularfire2/auth';\nimport { BaseService } from '../base/base.service';\n// import { Promise } from 'firebase';\nimport * as firebase from 'firebase';\n\n@Injectable()\nexport class AuthService extends BaseService{\n\n  constructor(\n    public auth: AngularFireAuth,\n    public http: Http\n  ) {\n    super();  // / (baseService)\n  }\n\n  createAuthUser(user: {email: string, password: string}): firebase.Promise<FirebaseAuthState> {\n    // function with parameter user object, return a firebase promise of type firebaseauthstate\n   // create an authentication user with the Angular Fire Auth service\n return this.auth.createUser(user)\n      .catch(this.handlePromiseError); \n  }\n  signInWithEmail(user: {email: string, password: string}): firebase.Promise<boolean> {\n    return this.auth.login(user)\n      .then((authState: FirebaseAuthState) => {\n        return authState != null; // returns true if authState is other than null (ie, logout)\n\n      })\n      .catch(this.handlePromiseError);\n  }\n\n  logOut(): Promise<void>{\n    return this.auth.logout();\n  }\n\n  get authenticated(): Promise<boolean> {\n        return new Promise((resolve, reject) => {\n      this.auth\n      .first()  // just get the first change\n      .subscribe((authState: FirebaseAuthState) => {\n        // (authState) ? resolve(true) : reject(false);   // if authState is true, returns true\n        (authState) ? resolve(true) : reject(Error);   // if authState is true, returns true\n      })\n    })\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/providers/auth/auth.service.ts","import { Injectable, Inject } from '@angular/core';\nimport { Http } from '@angular/http';\nimport 'rxjs/add/operator/map';\n\nimport { AngularFire, FirebaseListObservable, FirebaseObjectObservable, FirebaseApp } from 'angularfire2';\nimport { FirebaseAuthState } from 'angularfire2/auth';\nimport { User } from '../../models/user.model'; // importa a classe de User que compõe o formulário\nimport { BaseService } from '../base/base.service';\nimport { Observable } from 'rxjs';\n// import { FirebaseApp } from 'angularfire2/tokens';\n// import { FirebaseObjectObservable } from 'angularfire2/database';\n\n@Injectable()\nexport class UserService extends BaseService{\n\n  users: FirebaseListObservable<User[]>;    //attribute array of users of type (model) User\n  currentUser: FirebaseObjectObservable<User>;\n\n  constructor(\n    public af: AngularFire,\n\n    @Inject(FirebaseApp) public firebaseApp: any,\n    public http: Http,\n  ) {\n    super();\n    // this.users = this.af.database.list(`/users`);\n    this.listenAuthState();\n  }\n\n  private listenAuthState(): void {\n    this.af.auth.subscribe((authState: FirebaseAuthState) => {\n      if(authState) {\n        this.currentUser = this.af.database.object(`/users/${authState.auth.uid}`);\n        this.setUsers(authState.auth.uid)\n        // current user\n      }\n    });\n  }\n\n  private setUsers(uidToExclude: string): void {\n    this.users = <FirebaseListObservable<User[]>> this.af.database.list(`/users`, {\n      query: {\n        orderByChild: 'name'   //order by name\n      }\n    }).map((users: User[]) => { //filter\n      return users.filter((user: User) => user.$key !== uidToExclude);\n        // will only catch users who do not have the same id as the current user (uid to exclude0)\n\n    })\n  }\n\n  create(user: User, userUniqueId: string): firebase.Promise<void> {\n      // The create function has the user parameter of type User (folder models) and returns a firebase.promise EMPTY (void)\n         // return this.users.push (user); // the users attribute is a listing of the '/ users' node. The push method is to add\n\n         // If the path does not exist (from the parameter below), it will set (.set ()) the user in that path (not to duplicate)\n       return this.af.database.object(`/users/${userUniqueId}`)\n      .set(user)\n      .catch(this.handlePromiseError);\n\n  }\n\n  edit(user: {name: string, username: string, photo: string}): firebase.Promise<void> {\n    return this.currentUser\n      .update(user)\n      .catch(this.handlePromiseError)\n  }\n\n  userExists(username: string): Observable<boolean> {\n    return this.af.database.list(`/users`, {\n      query: {\n        orderByChild: 'username', // sort by 'username' attribute\n        equalTo: username // that is equal to the username passed\n      }\n    }).map((users: User[]) => { // return is an array of type User\n      return users.length > 0;  //  if the users array is greater than 0, it returns TRUE, if not, FALSE\n    }).catch(this.handleObservableError);  // Error handling with BaseService handleObservableError method\n\n    // return null;\n  }\n\n  emailAlreadyInUse(email: string): Observable<boolean> {\n    return this.af.database.list(`/users`, {\n      query: {\n        orderByChild: 'email', // sorts the 'username' attribute of each node\n        equalTo: email //that is equal to the last username\n      }\n    }).map((users: User[]) => {// return is an array of type User\n      return users.length > 0;   // if the users array is greater than 0, it returns TRUE, if not, FALSE\n    }).catch(this.handleObservableError); // Error handling with BaseService handleObservableError method\n    // return null;\n  }\n\n  getUser(userId: string): FirebaseObjectObservable<User> {\n    return <FirebaseObjectObservable<User>>this.af.database.object(`/users/${userId}`)\n      .catch(this.handleObservableError);\n  }\n\n  uploadPhoto (photoFile: File, userId: string): firebase.storage.UploadTask {\n         // I could get the userId by this.currentUser. $ key\n         return this.firebaseApp\n           .storage ()\n           .ref () // if left here it would store in root\n           .child (`/users/${userId}`) // stores in the users node with the key userId\n           .put (photoFile); // the parameter is the file that will be stored\n       }\n\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/providers/user/user.service.ts","export class Chat {\n    \n    public $key: string;\n     // it does not pass in the constructor pq this $ key is automatically generated in the firebase and would conflict when creating the chat\n \n    constructor(\n        public lastMessage: string,\n        public timeStamp: any,\n        public title: string,\n        public photo: string,\n    ) {}\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/models/chat.model.ts","import { Pipe, PipeTransform } from '@angular/core';\n\n@Pipe({\n  name: 'capitalize',\n})\nexport class CapitalizePipe implements PipeTransform {\n\n  transform(value: string, onlyFirst: boolean) {\n    // return value.toLowerCase();\n\n    if (onlyFirst) {\n      return value.charAt(0).toUpperCase()+ value.substr(1);\n    }\n    \n    let words: string[] = value.split(' ');\n    let final: string = '';\n\n    words.forEach((value: string, index: number, words: string[]) => {\n      final += value.charAt(0).toUpperCase() + value.substr(1).toLowerCase()+ ' ';\n    })\n    return final;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pipes/capitalize/capitalize.ts","import { Component, Input } from '@angular/core';\nimport { baseComponent } from '../base.component';\nimport { AlertController, App, MenuController  } from 'ionic-angular';\nimport { AuthService } from '../../providers/auth/auth.service';\nimport { User } from '../../models/user.model';\n\n@Component({\n  selector: 'custom-logged-header',\n  templateUrl: 'custom-logged-header.component.html'\n})\nexport class CustomLoggedHeaderComponent extends baseComponent{\n\n  @Input() title: string;\n  @Input() user: User;\n  // @input is a visible property for the other components\n  constructor(\n    public alertCtrl: AlertController,\n    public authService: AuthService,\n    public app: App,\n    public menuCtrl: MenuController\n  ) {\n    super(alertCtrl,authService,app,menuCtrl);\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/custom-logged-header/custom-logged-header.component.ts","import { Component, Input } from '@angular/core';\n\nimport { Message } from './../../models/message.model';\n\n/* no host fica tipo assim\n  <message-box [style.justify-content]=\"flex-start\"> </message-box>\n*/\n\n@Component({\n  selector: 'message-box',\n  templateUrl: 'message-box.component.html',\n  host: {\n   // can take properties in the element and make input property (placing a style (class) conditionally)\n   '[style.justify-content]': '((!isFromSender) ? \"flex-start\" : \"flex-end\")',\n  // If it is NOT the sender, it is on the left, if it is, it is on the right\n    // '[style.text-align]': '((!isFromSender) ? \"left\" : \"right\")'\n  }\n})\nexport class MessageBoxComponent {\n\n  // the decorator Input allows you to pass values from the view here\n; @Input() message: Message;\n  @Input() isFromSender: boolean;\n  @Input() alreadyRead: boolean;\n\n  constructor() {}\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/message-box/message-box.component.ts","import { Component } from '@angular/core';\nimport { Platform } from 'ionic-angular';\nimport { StatusBar } from '@ionic-native/status-bar';\nimport { SplashScreen } from '@ionic-native/splash-screen';\n\nimport { FirebaseAuthState } from 'angularfire2';\n\nimport { AuthService } from './../providers/auth/auth.service';\nimport { HomePage } from '../pages/home/home';\nimport { SigninPage } from '../pages/signin/signin';\nimport { User } from '../models/user.model';\nimport { UserService } from '../providers/user/user.service';\n// import { FirebaseAuthState } from 'angularfire2/auth';\n\n@Component({\n  templateUrl: 'app.html'\n})\nexport class MyApp {\n  \n  rootPage:any = SigninPage;\n  currentUser: User;\n\n  constructor(\n    authService: AuthService,\n    platform: Platform,\n    statusBar: StatusBar,\n    splashScreen: SplashScreen,\n    userService: UserService\n  ) {\n\n    authService.auth.subscribe((authState: FirebaseAuthState) => {\n      if (authState) {\n        this.rootPage = HomePage;\n        userService.currentUser.subscribe((user: User) => {\n          this.currentUser = user;  // receives the user who is currently logged in\n        })\n      } else {\n        this.rootPage = SigninPage;\n      }\n    })\n\n    platform.ready().then(() => {\n      statusBar.styleDefault();\n      splashScreen.hide();\n    });\n\n  }\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/app.component.ts","import { Component, Input } from '@angular/core';\n\n@Component({\n  selector: 'progress-bar',\n  templateUrl: 'progress-bar.component.html'\n})\nexport class ProgressBarComponent {\n\n  @Input() progress: number;\n\n  constructor() {}\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/progress-bar/progress-bar.component.ts","import { Component, Input } from '@angular/core';\nimport { User } from '../../models/user.model';\n\n@Component({\n  selector: 'user-info',\n  templateUrl: 'user-info.component.html'\n})\nexport class UserInfoComponent {\n\n  @Input() user: User;\n  @Input() isMenu: boolean = false;\n\n  constructor() {}\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/user-info/user-info.component.ts","import { Component, Input } from '@angular/core';\nimport { AlertController, App, MenuController } from 'ionic-angular';\n\nimport { AuthService } from '../../providers/auth/auth.service';\nimport { baseComponent } from '../base.component';\nimport { User } from '../../models/user.model';\nimport { UserProfilePage } from './../../pages/user-profile/user-profile';\n\n@Component({\n  selector: 'user-menu',\n  templateUrl: 'user-menu.component.html'\n})\nexport class UserMenuComponent extends baseComponent {\n\n   // inside .ts if it references it as currentUser, but there in HTML it calls user\n   @Input('user') currentUser: User;  \n\n  constructor(\n    public alertCtrl: AlertController,\n    public authService: AuthService,\n    public app: App,\n    public menuCtrl: MenuController\n  ) {\n    super(alertCtrl, authService, app, menuCtrl);\n  }\n\n  onProfile(): void {\n    this.navCtrl.push(UserProfilePage);\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/user-menu/user-menu.component.ts","import { Response } from '@angular/http';\nimport { Observable } from 'rxjs';\n\nconst extractError = (error: Response | any): string => {\n    // In a real world app, we might use a remote logging infrastructure\n    let errMsg: string;\n    if (error instanceof Response) {\n        const body = error.json() || '';\n        const err = body.error || JSON.stringify(body);\n        errMsg = `${error.status} - ${error.statusText || ''} ${err}`;\n    } else {\n        errMsg = error.message ? error.message : error.toString();\n    }\n    console.error(errMsg);\n\n    return errMsg;\n}\n\nexport abstract class BaseService {\n// exporting abstract class that can not be instantiated. It just needs to be INHERITED by other classes!\nprotected handlePromiseError(error: Response | any): Promise<any> {\n        return Promise.reject(extractError(error));\n    }\n\n    protected handleObservableError(error: Response | any): Observable<any> {\n        return Observable.throw(extractError(error));\n    }\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/providers/base/base.service.ts","import { Component } from '@angular/core';\nimport { MenuController, NavController, Loading, LoadingController } from 'ionic-angular';\n\nimport { FirebaseListObservable } from 'angularfire2/database';\n\nimport { AuthService } from '../../providers/auth/auth.service';\nimport { Chat } from '../../models/chat.model';\nimport { ChatPage } from './../chat/chat';\nimport { ChatService } from '../../providers/chat/chat.service';\nimport { SignupPage } from '../signup/signup';\nimport { User } from '../../models/user.model';\nimport { UserService } from './../../providers/user/user.service';\n\nimport firebase from 'firebase';\n\n@Component({\n  selector: 'page-home',\n  templateUrl: 'home.html'\n})\nexport class HomePage {\n\n  users: FirebaseListObservable<User[]>;  // users attribute is an array of Users of type FireBase Observable\n\n  chats: FirebaseListObservable<Chat[]>;\n  view: string = 'chats';\n\n  constructor(\n    public authService: AuthService,\n    public chatService: ChatService,\n    public loadingCtrl: LoadingController,\n    public menuCtrl: MenuController,\n    public navCtrl: NavController,\n    public userService: UserService,  // injects the user service\n  ) {\n\n  }\n\n  ionViewCanEnter(): Promise<boolean> {\n    return this.authService.authenticated;\n  }\n\n  ionViewDidLoad() {\n\n    this.showLoading();\n\n    this.chats = this.chatService.chats;\n    this.users = this.userService.users;\n    //the users attribute of this page is the same as the attribute of the user service\n    this.menuCtrl.enable(true, 'user-menu');// enable the menu when entering the home page\n\n  }\n\n  onSignup(): void {\n    this.navCtrl.push(SignupPage);\n  }\n\n  onChatCreate(recipientUser: User): void {\n    \n    this.userService.currentUser   //has to have the subscribe for being a promise and we are 'listening' to the changes\n      .first()\n      .subscribe((currentUser: User) => { // the current user is the current user\n        this.chatService.getDeepChat(currentUser.$key,recipientUser.$key) //passes the users UID\n          .first()  \n          .subscribe((chat: Chat) => {  // get a chat IF THERE'S in server\n            \n            if(chat.hasOwnProperty('$value')) {  // chat has its own property called '$ value'?\n            // If you have, it does not exist\n              let timestamp: Object = firebase.database.ServerValue.TIMESTAMP; // take the timestamp from the server\n              \n              let chat1 = new Chat('',timestamp,recipientUser.name, (recipientUser.photo || '')); // take the timestamp from the server\n              this.chatService.create(chat1,currentUser.$key,recipientUser.$key);\n              \n              let chat2 = new Chat('',timestamp,currentUser.name,(currentUser.photo || ''));\n              this.chatService.create(chat2,recipientUser.$key,currentUser.$key);\n            }\n\n          });\n          \n      })\n      this.navCtrl.push(ChatPage, {\n        recipientUser: recipientUser  // sends the parameter that is the recipient of the message to the ChatPage page\n\n      });\n  }\n\n  onChatOpen(chat: Chat): void {\n    let recipientUserId: string = chat.$key; // receives the recipient user ID\n    this.userService.getUser(recipientUserId)\n      .first()\n      .subscribe((user: User) => {\n        this.navCtrl.push(ChatPage, {\n          recipientUser: user  // sends the parameter that is the recipient of the message to the ChatPage page\n        });\n      });\n  }\n  \n  filterItems(event: any): void {\n    let searchTerm: string = event.target.value;\n    this.chats = this.chatService.chats;\n    this.users = this.userService.users;\n\n    if (searchTerm) {\n      switch(this.view) {\n\n        case 'chats':\n          this.chats = <FirebaseListObservable<Chat[]>>this.chats\n            .map((chats: Chat[]) => {\n              return chats.filter((chat: Chat) => {\n                // play in small to not have error in comparison\n                                 // if you return -1 there is no search term\n                return (chat.title.toLowerCase().indexOf(searchTerm.toLowerCase()) > -1);\n              })\n          })\n          break;\n\n        case 'users':\n          this.users = <FirebaseListObservable<User[]>>this.users\n            .map((users: User[]) => {\n              return users.filter((user: User) => {\n                  // play in small to not have error in comparison\n                                   // if you return -1 there is no search term\n                return (user.name.toLowerCase().indexOf(searchTerm.toLowerCase()) > -1);\n              })\n          })\n          break;\n      }\n    }\n  }  \n\n  \n  private showLoading(): Loading {\n    let loading: Loading = this.loadingCtrl.create({\n      content: \"Please wait...\",\n      duration: 200\n    });\n\n    loading.present();\n\n    return loading;\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/home/home.ts","import { Component } from '@angular/core';\nimport { AlertController, IonicPage, Loading, NavController, NavParams } from 'ionic-angular';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\n\nimport { AuthService } from '../../providers/auth/auth.service';\nimport { LoadingController } from 'ionic-angular/components/loading/loading-controller';\n\nimport { HomePage } from './../home/home';\nimport { SignupPage } from './../signup/signup';\n\n@IonicPage()\n@Component({\n  selector: 'page-signin',\n  templateUrl: 'signin.html',\n})\nexport class SigninPage {\n\n  signinForm: FormGroup;\n\n  constructor(\n    public alertCtrl: AlertController,\n    public authService: AuthService,\n    public formBuilder: FormBuilder,\n    public loadingCtrl: LoadingController,\n    public navCtrl: NavController,\n    public navParams: NavParams\n  ) {\n    let emailRegex = /^[a-z0-9!#$%&'*+\\/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)*$/i;    \n\n    this.signinForm = this.formBuilder.group({\n      email: ['', Validators.compose([Validators.required, Validators.pattern(emailRegex)])],\n      password: ['', [Validators.required, Validators.minLength(6)]]\n    });\n  }\n\n  onSignUp(): void {\n    this.navCtrl.push(SignupPage);\n  }\n\n  onSubmit(): void {\n    let loading: Loading = this.showLoading();  // return o loading\n    let user = this.signinForm.value;\n\n    this.authService.signInWithEmail(user)\n      .then((isLogged: boolean) => {\n        if (isLogged) {\n          this.navCtrl.setRoot(HomePage);\n          loading.dismiss();\n        }\n      })\n      .catch((er: any) => {\n        loading.dismiss();\n        this.showAlert(er)\n      })\n\n  }\n\n  private showLoading(): Loading {\n    let loading: Loading = this.loadingCtrl.create({\n      content: \"Please wait...\"\n    });\n\n    loading.present();\n\n    return loading;\n  }\n\n  private showAlert(message: string): void {\n    this.alertCtrl.create({\n      message: message,\n      buttons: ['Ok']\n    }).present();\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/signin/signin.ts","import { Component } from \"@angular/core\";\nimport { IonicPage, NavController, NavParams } from \"ionic-angular\";\nimport { Loading } from \"ionic-angular/components/loading/loading\";\n\nimport { FormBuilder, FormGroup, Validators } from \"@angular/forms\";\nimport { FirebaseAuthState } from \"angularfire2\";\n\nimport { AlertController } from \"ionic-angular/components/alert/alert-controller\";\nimport { LoadingController } from \"ionic-angular/components/loading/loading-controller\";\n\nimport { AuthService } from \"../../providers/auth/auth.service\";\nimport { UserService } from \"./../../providers/user/user.service\";\n// import { User } from '../../models/user.model';\n\nimport { HomePage } from \"./../home/home\";\n// import { emailValidator } from '../../validators/email';\n\n@IonicPage()\n@Component({\n  selector: \"page-signup\",\n  templateUrl: \"signup.html\"\n})\nexport class SignupPage {\n  signupForm: FormGroup; //FormGroup;\n  checkingEmail: boolean = true;\n\n  constructor(\n    public alertCtrl: AlertController,\n    public authService: AuthService,\n    public formBuilder: FormBuilder,\n    public loadingCtrl: LoadingController,\n    public navCtrl: NavController,\n    public navParams: NavParams,\n    public userService: UserService\n  ) {\n    // let emailRegex = /^[a-z0-9!#$%&'*+\\/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)*$/i;\n    let emailRegex = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n\n    this.signupForm = this.formBuilder.group({\n      name: [\"\", [Validators.required, Validators.minLength(3)]],\n      username: [\"\", [Validators.required, Validators.minLength(3)]],\n      email: [\n        \"\",\n        Validators.compose([\n          Validators.required,\n          Validators.pattern(emailRegex)\n        ])\n      ],\n      password: [\"\", [Validators.required, Validators.minLength(6)]]\n    });\n  }\n\n  onSubmit(): void {\n    let loading: Loading = this.showLoading();\n\n    let formUser = this.signupForm.value;\n\n    let username: string = formUser.username;\n\n    this.userService\n      .userExists(username)\n      .first()\n      .subscribe((userExists: boolean) => {\n         if (!userExists) {\n         \n          this.authService\n            .createAuthUser({\n                email: formUser.email,\n              password: formUser.password\n            })\n            .then((authState: FirebaseAuthState) => {\n               delete formUser.password;\n\n              \n              let userUniqueId: string = authState.auth.uid;\n\n              this.userService\n                .create(formUser, userUniqueId)  \n                .then(() => {\n                \n                  loading.dismiss();\n                  this.navCtrl.setRoot(HomePage);\n                })\n                .catch((error: any) => {\n                  loading.dismiss();\n                  this.showAlert(error);\n                });\n            })\n            .catch((error: any) => {\n              loading.dismiss();\n              this.showAlert(error);\n            });\n        } else {\n          this.showAlert(\"Username already in use! Pick another one.\");\n          loading.dismiss();\n        }\n      });\n  }\n\n  private showLoading(): Loading {\n    let loading: Loading = this.loadingCtrl.create({\n      content: \"Please wait...\"\n    });\n\n    loading.present();\n\n    return loading;\n  }\n\n  private showAlert(message: string): void {\n    this.alertCtrl\n      .create({\n        message: message,\n        buttons: [\"Ok\"]\n      })\n      .present();\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/signup/signup.ts"],"sourceRoot":""}